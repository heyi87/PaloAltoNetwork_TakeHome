<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="28.2.9">
  <diagram id="rfm-ingestion-parser" name="Data Ingestion &amp; Parser Strategy">
    <mxGraphModel dx="1944" dy="1072" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="Data Ingestion &amp; Parser Strategy" style="text;html=1;strokeColor=none;fillColor=none;fontSize=26;fontStyle=1;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="250" y="20" width="1100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sourcesHdr" value="Sources" style="rounded=1;whiteSpace=wrap;html=1;fontStyle=1;align=center;verticalAlign=top;spacing=12;fillColor=#ffffff;strokeColor=#111111;fontSize=17;" parent="1" vertex="1">
          <mxGeometry x="80" y="100" width="380" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sourcesBox" value="Paths (inputs)&#xa;• users → DE_DS_PracticeFiles/USERS.csv&#xa;• products → DE_DS_PracticeFiles/PRODUCTS.csv&#xa;• orders → DE_DS_PracticeFiles/ORDERS.csv&#xa;• order_items → DE_DS_PracticeFiles/ORDER_ITEMS.csv" style="rounded=1;whiteSpace=wrap;html=1;align=left;verticalAlign=top;spacing=12;fillColor=#f7f7f7;strokeColor=#999999;fontSize=18;" parent="1" vertex="1">
          <mxGeometry x="80" y="140" width="380" height="220" as="geometry" />
        </mxCell>
        <mxCell id="parsersHdr" value="Parsers" style="rounded=1;whiteSpace=wrap;html=1;fontStyle=1;align=center;verticalAlign=top;spacing=12;fillColor=#ffffff;strokeColor=#111111;fontSize=17;" parent="1" vertex="1">
          <mxGeometry x="540" y="100" width="520" height="40" as="geometry" />
        </mxCell>
        <mxCell id="usersParser" value="USERS.csv (semi-structured)&#xa;• Parse JSON-ish rows:&#xa;  – extract id&#xa;  – &#39;/key/value&#39; tokens → fields&#xa;  – merge valid JSON if present&#xa;• Rename: firstname→first_name, lastname→last_name, e_mail→email" style="rounded=1;whiteSpace=wrap;html=1;align=left;verticalAlign=top;spacing=12;fillColor=#eaf3ff;strokeColor=#5b8def;fontSize=18;" parent="1" vertex="1">
          <mxGeometry x="540" y="150" width="520" height="170" as="geometry" />
        </mxCell>
        <mxCell id="productsParser" value="PRODUCTS.csv (array-in-file)&#xa;• If file starts with &#39;[&#39; → json.loads → DataFrame&#xa;• Else: one-cell CSV → json.loads(first cell)" style="rounded=1;whiteSpace=wrap;html=1;align=left;verticalAlign=top;spacing=12;fillColor=#eaf3ff;strokeColor=#5b8def;fontSize=18;" parent="1" vertex="1">
          <mxGeometry x="540" y="330" width="520" height="120" as="geometry" />
        </mxCell>
        <mxCell id="normHdr" value="Normalization (ORDERS / ORDER_ITEMS)" style="rounded=1;whiteSpace=wrap;html=1;fontStyle=1;align=center;verticalAlign=top;spacing=12;fillColor=#ffffff;strokeColor=#111111;fontSize=17;" parent="1" vertex="1">
          <mxGeometry x="1120" y="100" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="normBox" value="CSV normalization&#xa;• Standardize headers → snake_case&#xa;• Trim strings (&#39;&#39;/nan/none/null → NaN)&#xa;• Detect &amp;amp; coerce all date-like cols to UTC → tz-naive&#xa;• Numericize revenue/qty with errors=&#39;coerce&#39;&#xa;• Persist detected datetime cols (df.attrs[&#39;datetime_cols&#39;])" style="rounded=1;whiteSpace=wrap;html=1;align=left;verticalAlign=top;spacing=12;fillColor=#f7f7f7;strokeColor=#999999;fontSize=18;" parent="1" vertex="1">
          <mxGeometry x="1120" y="140" width="400" height="240" as="geometry" />
        </mxCell>
        <mxCell id="arrow1" style="edgeStyle=elbowEdgeStyle;curved=0;endArrow=block;endFill=1;strokeColor=#333333;fontSize=18;" parent="1" source="sourcesBox" target="usersParser" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2" style="edgeStyle=elbowEdgeStyle;curved=0;endArrow=block;endFill=1;strokeColor=#333333;fontSize=18;" parent="1" source="usersParser" target="normBox" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3" style="edgeStyle=elbowEdgeStyle;curved=0;endArrow=block;endFill=1;strokeColor=#333333;fontSize=18;" parent="1" source="productsParser" target="normBox" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
